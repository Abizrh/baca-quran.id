<!DOCTYPE html>
<html lang="en" class="theme-light">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="%sveltekit.assets%/images/icon-32.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		%sveltekit.head%
	</head>
	<body data-sveltekit-preload-data="hover" id="body" class="bg-primary">
		<div style="display: contents">%sveltekit.body%</div>

		<script>
			(function () {
				// Unused for now
				window.__headerTheme = {
					light: '#f5f7fb',
					dark: '#172642',
					sepia: '#704214'
				};

				var __textColor = {
					light: 'text-gray-900',
					dark: 'text-gray-200',
					sepia: 'text-gray-200'
				};

				window.__theme = 'light';

				function setTheme(newTheme) {
					if (newTheme) {
						window.__theme = newTheme;
						document.querySelector('html').setAttribute('class', `theme-${newTheme}`);
						document
							.querySelector('body')
							?.setAttribute('class', `bg-primary ${__textColor[newTheme]}`);

						try {
							localStorage.setItem('theme', newTheme);
						} catch (err) {}
					}
				}

				window.__setActiveTheme = setTheme;

				// Run on the page load
				try {
          var t = localStorage.getItem('theme')
          if (t) {
					  window.__theme = t;
          }
				} catch (err) {}
				setTheme(window.__theme || 'light');
			})();
		</script>

		<!-- Install Service Worker -->
		<script>
			const registerServiceWorker = async () => {
				if ('serviceWorker' in navigator) {
					try {
						const registration = await navigator.serviceWorker.register('/sw.js', {
							scope: '/'
						});
						if (registration.installing) {
							console.debug('[Baca-Quran.id] > Service worker installing...');
						} else if (registration.waiting) {
							console.debug('[Baca-Quran.id] > Service worker installed!');
						} else if (registration.active) {
							console.debug('[Baca-Quran.id] > Service worker active!');
						}
					} catch (error) {
						console.error(`[Baca-Quran.id] > SW Registration failed with ${error}`);
					}
				}
			};
			registerServiceWorker();
		</script>
	</body>
</html>
